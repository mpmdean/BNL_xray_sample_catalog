<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Interactive Table</title>
  <meta name="description" content="CSV rendered as an interactive DataTable with itables">
  <style>
    body {
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', Arial, 'Noto Sans', sans-serif;
      padding: 2rem; max-width: 1100px; margin: auto;
    }
    h1 { font-weight: 600; }
    .note { color: #444; font-size: 0.95rem; margin-bottom: 1rem; }

    .table-wrap { width: 100%; overflow-x: auto; }

    /* Fixed layout = predictable widths; body cells may wrap */
    table.dataTable { table-layout: fixed; width: 100% !important; }

    /* BODY CELLS: allow wrapping and breaking long tokens */
    table.dataTable td {
      white-space: normal !important;
      word-break: break-word;
    }

    /* HEADERS: keep labels on a single line */
    table.dataTable thead th {
      white-space: nowrap !important;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* Column-specific minimum widths (by nth-child) */
    /* (no named min-width rules) */

    /* Optional: multi-line clamp for selected body columns */
    td.clamp-2 {
      display: -webkit-box;
      -webkit-box-orient: vertical;
      -webkit-line-clamp: 2;
      overflow: hidden;               /* hide beyond the clamp */
      line-height: 1.25;
      max-height: calc(1.25em * 2);
      position: relative;             /* anchor for hover preview */
      cursor: help;                   /* hint that more text exists */
    }

    /* Hover preview bubble (doesn't reflow table) */
    td.clamp-2:hover { overflow: visible; }
    td.clamp-2:hover::after {
      content: attr(data-full);       /* set dynamically from cell text */
      position: absolute;
      left: 0; top: 100%;
      z-index: 9999;
      white-space: normal;
      max-width: min(48ch, 60vw);
      margin-top: .25rem;
      padding: .5rem .6rem;
      background: rgba(0,0,0,.92);
      color: #fff;
      border-radius: .5rem;
      box-shadow: 0 8px 28px rgba(0,0,0,.25);
      pointer-events: none;           /* don't steal mouse events */
    }

    /* If the bubble would overflow viewport on the right, allow wrapping */
    @media (max-width: 640px) {
      td.clamp-2:hover::after { max-width: 80vw; }
    }
  </style>
</head>
<body>
  <h1>BNL Sample Catalog</h1>
  <p class="note">Edit the database <a href="https://github.com/mpmdean/BNL_xray_sample_catalog/blob/main/database.csv">here</a>.</p>
  <div class="table-wrap">
    <!--| quarto-html-table-processing: none -->
<table id="itables_96f812f8_5066_4002_8593_d657e33b1817"><tbody><tr>
    <td style="vertical-align:middle; text-align:left">
    
    Loading ITables v2.5.2 from the internet...
    (need <a href=https://mwouts.github.io/itables/troubleshooting.html>help</a>?)</td>
    </tr></tbody></table>
<link href="https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.css" rel="stylesheet">
<script type="module">
    import { ITable, jQuery as $ } from 'https://www.unpkg.com/dt_for_itables@2.4.0/dt_bundle.js';

    document.querySelectorAll("#itables_96f812f8_5066_4002_8593_d657e33b1817:not(.dataTable)").forEach(table => {
        if (!(table instanceof HTMLTableElement))
            return;

        let dt_args = {"classes": ["display"], "autoWidth": false, "columnDefs": [{"targets": 2, "width": "28ch"}, {"targets": 2, "className": "clamp-2"}], "layout": {"topStart": null, "topEnd": null, "bottomStart": null, "bottomEnd": null}, "order": [], "style": {"table-layout": "auto", "width": "auto", "margin": "auto", "caption-side": "bottom"}, "text_in_header_can_be_selected": true, "table_html": "<table><thead>\n    <tr style=\"text-align: right;\">\n      \n      <th>ID</th>\n      <th>Name</th>\n      <th>Owner</th>\n      <th>Origin</th>\n      <th>Notes</th>\n    </tr>\n  </thead></table>", "data_json": "[[\"00001A\", \"La2NiO4\", \"Xuefei Guo\", \"Doug Buttery via John Tranquada\", \"Big chunk\"], [\"00001B\", \"La2NiO4\", \"Xuefei Guo\", \"Doug Buttery via John Tranquada\", \"Big chunk\"], [\"2\", \"La4Ni3O8\", \"Xuefei Guo\", \"John Mitchel\", \"Used in Shen et al. Phys. Rev. X 12, 011055 (2022)\"]]"};
        new ITable(table, dt_args);
    });
</script>

  </div>

  <script>
    // Attach full text to clamped cells as both title=... (native tooltip)
    // and data-full (for the custom hover bubble). Re-apply on each draw.
    (function() {
      function annotateClampedCells(scope) {
        (scope.querySelectorAll ? scope : document).querySelectorAll('td.clamp-2').forEach(function(td) {
          var txt = (td.textContent || '').trim();
          if (txt) {
            if (!td.getAttribute('title')) td.setAttribute('title', txt);    // native tooltip
            td.setAttribute('data-full', txt);                                // custom bubble
          }
        });
      }

      function hookTables() {
        document.querySelectorAll('table.dataTable').forEach(function(tbl) {
          // initial pass
          annotateClampedCells(tbl);
          // on redraw (paging, sorting, search)
          if (window.jQuery && jQuery.fn && jQuery.fn.dataTable) {
            jQuery(tbl).on('draw.dt', function() { annotateClampedCells(tbl); });
          } else {
            // Fallback: periodic refresh if DataTables/jQuery not exposed
            setInterval(function(){ annotateClampedCells(tbl); }, 500);
          }
        });
      }

      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', hookTables);
      } else {
        hookTables();
      }
    })();
  </script>
</body>
</html>